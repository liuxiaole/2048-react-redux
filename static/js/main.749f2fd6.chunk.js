(this["webpackJsonp2048-react"]=this["webpackJsonp2048-react"]||[]).push([[0],{130:function(e,t,n){e.exports=n(245)},143:function(e,t){},145:function(e,t){},155:function(e,t){},157:function(e,t){},184:function(e,t){},185:function(e,t){},190:function(e,t){},192:function(e,t){},216:function(e,t){},239:function(e,t,n){},240:function(e,t,n){},241:function(e,t,n){},242:function(e,t,n){},244:function(e,t,n){},245:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(36),c=n.n(o),i=n(120),u=n(121),s=n(129),l=n(126),E=n(8),f=n(6),d=n(128),m=n(38),v=n(39),b=n.n(v),h=n(123),p=n.n(h),w=function(){return function(e,t){var n=function(e){var t=b()(e.map((function(e,t){return e.map((function(e,n){return e?null:[t,n]}))}))).filter((function(e){return!!e}));if(t.length){var n=Math.floor(Math.random()*t.length),r=Object(d.a)(t[n],2);return{row:r[0],col:r[1]}}return null}(t().tiles);return!!n&&(e(Object(f.a)({type:"GENERATE_NEW_TILE",number:Math.random()>.8?4:2,uuid:Object(m.v4)()},n)),!0)}},_=function(e){return function(t){return t(Object(f.a)({type:"MOVE_TILE"},e)),(n=80,new p.a((function(e){return setTimeout(e,n)}))).then((function(){return e}));var n}},T=function(e){return Object(f.a)({type:"PRE_MERGE_TILE"},e)},g=function(e){return{type:"MERGE_TILE",row:e.row,col:e.col}},O=function(){return function(e,t){e({type:"START_NEW_GAME",size:t().size}),e(w()),e(w())}},N={up:[0,-1],down:[0,1],left:[-1,0],right:[1,0]},S=(n(239),function(e){var t=e.label,n=e.score,r=e.children;return a.a.createElement("div",{className:"score-box"},a.a.createElement("div",{className:"score-label"},t),a.a.createElement("div",{className:"score-content"},n),r)}),R=Object(E.b)((function(e){return e.scores}),(function(e){return{onAnimationEnd:function(t){return e(function(e){return{type:"CLEAN_RECENT_ADDED_SCORE",id:e}}(t))},startNewGame:function(){return e(O())}}}))((function(e){return a.a.createElement("div",{className:"header-box"},a.a.createElement("h1",{className:"title"},"2048"),a.a.createElement(S,{score:e.score,label:"SCORE"},e.recentAddedScores.map((function(t){return a.a.createElement("div",{className:"addition-score",key:t.id,onAnimationEnd:function(n){return e.onAnimationEnd(t.id)}},"+",t.score)}))),a.a.createElement(S,{score:e.bestScore,label:"BEST"}),a.a.createElement("div",{className:"desc-txt"},a.a.createElement("span",{className:"bold"},"Play 2048 Game Online"),a.a.createElement("br",null),"Join the numbers and get to the ",a.a.createElement("span",{className:"bold"},"2048 tile!")),a.a.createElement("button",{className:"new-game-btn",onClick:e.startNewGame},"New Game"))})),y=(n(240),Object(E.b)()((function(e){var t=e.dispatch;return a.a.createElement("div",{className:"game-over"},a.a.createElement("h1",{className:"title"},"Game Over!"),a.a.createElement("button",{onClick:function(){return t(O())}},"Try Again"))}))),A=n(24),G=(n(241),function(e){var t,n=e.col,r=e.row,o=(t={tile:!0},Object(A.a)(t,"tile-".concat(e.number),!0),Object(A.a)(t,"tile-new",e.newGenerated),Object(A.a)(t,"tile-merged",!!e.newMerged),t),c=Object.keys(o).filter((function(e){return!!o[e]})).join(" "),i=110*r+"px",u={transform:"translate3d(".concat(110*n+"px",", ").concat(i,", 0)")};return a.a.createElement("div",{className:c,style:u},a.a.createElement("div",{className:"tile-inner",onAnimationEnd:e.onAnimationEnd},e.number))});G=Object(E.b)(null,(function(e,t){return{onAnimationEnd:function(n){var r,a,o=n.animationName,c=t.col,i=t.row;"a-tile-new"===o?e({type:"RESET_NEW_GENERATED_TILE_TAG",row:(a={col:c,row:i}).row,col:a.col}):"a-tile-merged"===o&&e({type:"RESET_NEW_MERGED_TILE_TAG",row:(r={col:c,row:i}).row,col:r.col})}}}))(G);var M=function(e){var t=[];return b()(e).filter((function(e){return!!e})).forEach((function(e){t.push(e),e.tileToMerge&&t.push(e.tileToMerge)})),t.sort((function(e,t){return e.uuid>t.uuid?1:-1}))},j=Object(E.b)((function(e){var t=e.tiles;return{flatTiles:M(t)}}))((function(e){var t=e.flatTiles;return a.a.createElement("div",{className:"tile-container"},t.map((function(e){return a.a.createElement(G,Object.assign({key:"tile-"+e.uuid},e))})))})),C=(n(242),function(e){var t=e.size,n=new Array(t).fill().map((function(e,n){return function(e){return new Array(t).fill().map((function(n,r){return a.a.createElement("div",{className:"grid-cell",key:"grid-cell-".concat(e*t+r)})}))}(n)}));return a.a.createElement("div",{className:"grid-container"},n)}),D=Object(E.b)((function(e){return{size:e.size,gameOver:"over"===e.gameStatus}}))((function(e){return a.a.createElement("div",{className:"game-board"},a.a.createElement(R,null),a.a.createElement("div",{className:"game-box"},a.a.createElement(C,{size:e.size}),a.a.createElement(j,null),e.gameOver&&a.a.createElement(y,null)),a.a.createElement("a",{href:"https://github.com/liuxiaole/2048-react-redux",className:"view-score-link"},"view source on github"))})),L=n(124),k=n.n(L),I=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.startNewGame(),this.handleKeyPress=this.handleKeyPress.bind(this),this.handleSwiped=this.handleSwiped.bind(this),window.addEventListener("keydown",this.handleKeyPress)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyPress)}},{key:"handleKeyPress",value:function(e){var t=e.key;if(this.props.gameStarted){var n=t.toLowerCase().match(/arrow(up|right|down|left)/);n&&(this.move(n[1]),e.preventDefault())}}},{key:"handleSwiped",value:function(e){if(this.props.gameStarted)return this.move(e),!1}},{key:"move",value:function(e){var t=this;if(!this.isMoving){var n=this.props.moveChessBoard(e),r=n.movingPromise,a=n.score;r&&(this.isMoving=!0,r.then((function(){a&&t.props.addScore(a),t.isMoving=!1,t.props.generateNewTile(),t.checkGameStatus()})))}}},{key:"isMovable",value:function(){var e,t=!1,n=this.props,r=n.tiles,a=n.size;return e=function(e){if(!t)if(e){var n=e.row,o=e.col;if(n<a-1){var c=r[n+1][o];if(c&&c.number===e.number)return void(t=!0)}if(o<a-1){var i=r[n][o+1];if(i&&i.number===e.number)return void(t=!0)}}else t=!0},r.forEach((function(t){return t.forEach(e)})),t}},{key:"checkGameStatus",value:function(){this.isMovable()||(this.props.updateBestScore(this.props.score),this.props.setGameOver())}},{key:"render",value:function(){var e=this,t=["up","right","down","left"].reduce((function(t,n){return t["on-swiped-".concat(n).replace(/-(\w)/g,(function(e,t){return t.toUpperCase()}))]=e.handleSwiped.bind(e,n),t}),{});return a.a.createElement(k.a,Object.assign({},t,{preventDefaultTouchmoveEvent:!0}),a.a.createElement(D,null))}}]),n}(r.Component),W=Object(E.b)((function(e){return{size:e.size,tiles:e.tiles,score:e.scores.score,gameStarted:"playing"===e.gameStatus}}),(function(e){return{startNewGame:function(){return e(O())},setGameOver:function(){return e({type:"GAME_OVER"})},generateNewTile:function(){return e(w())},moveChessBoard:function(t){return e(function(e){return function(t,n){for(var r,a=n(),o=a.size,c=a.tiles,i=N[e],u=0,s=0;s<o;s++)for(var l=0;l<o;l++){var E=s,f=l;"right"===e&&(f=o-l-1),"down"===e&&(E=o-s-1);var d=c[E][f];if(d){for(var m=f+i[0],v=E+i[1],b=void 0;m>=0&&m<o&&v>=0&&v<o&&!(b=c[v][m]);)m+=i[0],v+=i[1];if(b&&!b.tileToMerge&&b.number===d.number){var h={col:f,row:E,destCol:m,destRow:v};t(T(h)),(r=t(_(h))).then((function(e){var n=e.destCol,r=e.destRow;t(g({row:r,col:n}))})).catch((function(e){return console.trace(e)})),c=n().tiles,u+=b.number+d.number}else{if(m-=i[0],v-=i[1],m!==f||v!==E)r=t(_({row:E,col:f,destRow:v,destCol:m})),c=n().tiles}}}return{movingPromise:r,score:u}}}(t))},addScore:function(t){return e(function(e){return{type:"ADD_SCORE",id:Object(m.v4)(),score:e}}(t))},updateBestScore:function(t){return e(function(e){return function(t,n){var r=n().scores.bestScore;r=Math.max(r,e),localStorage.setItem("bestScore",r),t({type:"UPDATE_BEST_SCORE",bestScore:r})}}(t))}}}))(I),P=(n(244),n(12)),z=n(125),x=n(127),B=Object(P.c)({score:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_NEW_GAME":return 0;case"ADD_SCORE":return e+t.score;default:return e}},bestScore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_BEST_SCORE":return t.bestScore;default:return e}},recentAddedScores:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_NEW_GAME":return[];case"ADD_SCORE":return[].concat(Object(x.a)(e),[{score:t.score,id:t.id}]);case"CLEAN_RECENT_ADDED_SCORE":return e.filter((function(e){return e.id!==t.id}));default:return e}}}),K=function(e){for(var t=[],n=0;n<e;n++)for(var r=t[n]=[],a=0;a<e;a++)r[a]=null;return t},U=function(e,t,n){return function(r){return e.map((function(e,a){return a!==t?e:e.map((function(e,t){return t!==n?e:r(e)}))}))}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GENERATE_NEW_TILE":return{number:t.number,newGenerated:!0,newMerged:!1,tileToMerge:null,uuid:t.uuid,col:t.col,row:t.row};case"RESET_NEW_GENERATED_TILE_TAG":return Object(f.a)(Object(f.a)({},e),{},{newGenerated:!1});case"MERGE_TILE":return Object(f.a)(Object(f.a)({},e),{},{number:e.number+e.tileToMerge.number,newMerged:!0});case"PRE_MERGE_TILE":return Object(f.a)(Object(f.a)({},e),{},{tileToMerge:t.tileToMerge});case"RESET_NEW_MERGED_TILE_TAG":return Object(f.a)(Object(f.a)({},e),{},{newMerged:!1,tileToMerge:null});default:return e}},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_NEW_GAME":return K(t.size);case"GENERATE_NEW_TILE":case"RESET_NEW_MERGED_TILE_TAG":case"RESET_NEW_GENERATED_TILE_TAG":case"MERGE_TILE":return U(e,t.row,t.col)((function(e){return V(e,t)}));case"PRE_MERGE_TILE":var n=e[t.destRow][t.destCol];return e=U(e,t.row,t.col)((function(e){return V(e,Object(f.a)(Object(f.a)({},t),{},{tileToMerge:n}))})),U(e,t.destRow,t.destCol)((function(e){return null}));case"MOVE_TILE":var r=e[t.row][t.col];return e=U(e,t.row,t.col)((function(e){return null})),U(e,t.destRow,t.destCol)((function(e){return Object(f.a)(Object(f.a)({},r),{},{col:t.destCol,row:t.destRow})}));default:return e}},X=Object(P.c)({size:function(){return 4},scores:B,tiles:J,gameStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"over",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_NEW_GAME":return"playing";case"GAME_OVER":return"over";default:return e}}}),q=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||P.d,F={};try{var H=localStorage.getItem("bestScore");H&&(H=JSON.parse(H),F.scores={bestScore:H})}catch(Y){}var Q=Object(P.e)(X,F,q(Object(P.a)(z.a)));c.a.render(a.a.createElement(E.a,{store:Q},a.a.createElement(W,null)),document.getElementById("root"))}},[[130,1,2]]]);
//# sourceMappingURL=main.749f2fd6.chunk.js.map